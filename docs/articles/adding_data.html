<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding data to AusTraits • austraits.build</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding data to AusTraits">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">austraits.build</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
    home
  </a>
</li>
<li>
  <a href="../articles/austraits.build.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Details
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/austraits_structure.html">Structure of `AusTraits` data compilation</a>
    </li>
    <li>
      <a href="../articles/Trait_definitions.html">Definitions for traits in `AusTraits`</a>
    </li>
    <li>
      <a href="../articles/austraits_raw_data.html">Structure of raw data in `AusTraits`</a>
    </li>
    <li>
      <a href="../articles/adding_data.html">Adding data to `AusTraits`</a>
    </li>
    <li>
      <a href="../articles/Docker.html">Docker for reproducible compute environment</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-list"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/traitecoevo/austraits.build">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adding data to AusTraits</h1>
            
            <h4 class="date">2020-03-25</h4>
      
      
      <div class="hidden name"><code>adding_data.Rmd</code></div>

    </div>

    
    
<p>This sections explains how to format files to contribute a new study to AusTraits. Before starting this, you should read more about the <a href="austraits_structure.html">structure of the compiled AusTraits database</a>, the <a href="austraits_raw_data.html">structure of the raw data files</a>, and <a href="building_austraits.html">how to build AusTraits</a>.</p>
<p>It is important that all steps are followed so that our automated workflow proceeds without problems.</p>
<p>The main steps are:</p>
<ol style="list-style-type: decimal">
<li>Clone the <code>austraits.build</code> repository from github and create a new branch in the repo with the name of your dataset_id.</li>
<li>Create a new folder within the folder <code>data</code> with a name of the <code>dataset_id</code>, e.g. <code>Gallagher_2014</code>.</li>
<li>Prepare the files <code>data.csv</code> and <code>metadata.yml</code> and place them within the folder.</li>
<li>Add the new study into the build framework and rebuild AusTraits.</li>
<li>Run tests on the contributed data and correct the <code>data.csv</code> and <code>metadata.yml</code>files as necessary.</li>
<li>Generate and proofread a report on the data. In particular, check that numeric trait values fall within a logical range relative to other studies and that individual trait observations are not unnecessarily excluded because their trait values are unsupported.</li>
<li>Return to step 3 if changes are made to the <code>data.csv</code> or <code>metadata.yml</code> files.</li>
<li>Push to GitHub.</li>
</ol>
<p>It may help to download one of the <a href="https://github.com/traitecoevo/austraits/tree/master/data">existing datasets</a> and use it as a template for your own files and a guide on required content. You should look at the files in the <a href="https://github.com/traitecoevo/austraits/tree/master/config">config folder</a>, in particular the <code>definitions</code> files for the list of traits we cover and the supported trait values for each trait. Or read through information on the supported traits and trait values.</p>
<p>Once you have prepared your <code>data.csv</code> and <code>metadata.yml</code> files within a folder in the <code>data</code> directory, you can incorporate the new data into Austraits by running:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="../reference/austraits_rebuild_remake_setup.html">austraits_rebuild_remake_setup</a></span>()</a></code></pre></div>
<p>This step updates the file <code>remake.yml</code> with appropriate rules for the new dataset; similarly if you remove datasets, do the same. (At this stage, <a href="https://github.com/richfitz/remake">remake</a> offers no looping constructs so for now we generate the remake file using <a href="https://github.com/edwindj/whisker">whisker</a>.)</p>
<p>You can then rebuild Austraits, including your dataset.</p>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>The <code>austraits.build</code> repository includes a bunch of functions that help build the repository. To use these, you’ll need to make them available.</p>
<p>The easiest way is to load the functions into your workspace is to run the following (from within the repository)</p>
</div>
<div id="inputting-data" class="section level1">
<h1 class="hasAnchor">
<a href="#inputting-data" class="anchor"></a>Inputting data</h1>
<div id="constructing-the-data-csv-file" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-the-data-csv-file" class="anchor"></a>Constructing the <code>data.csv</code> file</h2>
<!-- Lizzy - add details -->
</div>
<div id="constructing-the-metadata-yml-file" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-the-metadata-yml-file" class="anchor"></a>Constructing the <code>metadata.yml</code> file</h2>
<p>One way to construct the <code>metadata.yml</code> file is to use one of the existing files and modify yours to follow the same format. As a start, checkout some examples from <a href="https://github.com/traitecoevo/austraits/tree/master/data">existing studies in Austraits</a>, e.g. <a href="https://github.com/traitecoevo/austraits/blob/master/data/Angevin_2010/metadata.yml">Angevin_2010</a> or <a href="https://github.com/traitecoevo/austraits/blob/master/data/Wright_2004/metadata.yml">Wright_2004</a>.</p>
<p>Note, when editing the <code>metadata.yml</code>, edits should be made in a proper text editor (Microsoft word tends to stuff up the formatting). For example, Rstudio, textmate, sublime text, and Visual Studio Code are all good editors.</p>
<p>To assist you in constructing the <code>metadata.yml</code> file, we have developed functions to help fill in the different sections of the file. If you wish to include additional elements, you can afterwards edit the file further.</p>
<p>To use the functions, make sure you first run the following, to make the functions available</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(austraits.build)</a></code></pre></div>
<p>OR</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/load_all.html">load_all</a></span>()</a></code></pre></div>
<div id="creating-a-template" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-template" class="anchor"></a>Creating a template</h3>
<p>The first function creates a basic template for your the <code>metadata.yml</code> file for your study. Assuming you have already created a file <code>data.csv</code> in the folder <code>data/your_dataset_id</code>, run</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/metadata_create_template.html">metadata_create_template</a></span>(dataset_id)</a></code></pre></div>
<p>The function will ask a series of questions and then create a relatively empty file <code>data/your_dataset_id/metadata.yml</code>. The key questions are:</p>
<ul>
<li>Is the data long vs wide? A wide dataset has each variable(i.e. trait ) as a column. A long dataset has each variable as a row and column as a species. <em>Select column for ‘species_name’ </em>Select column for ‘site_name’</li>
</ul>
</div>
<div id="adding-a-source" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-a-source" class="anchor"></a>Adding a source</h3>
<p>Three functions are available to help entering citation details for the source data.</p>
<p>The function <code>metadata_create_template</code> creates a template for the primary source with default fields for a journal article, which you can then edit manually.</p>
<p>Alternatively, if you have a <code>doi</code> for your study, use the function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/metadata_add_source_doi.html">metadata_add_source_doi</a></span>(dataset_id, doi)</a></code></pre></div>
<p>and the different elements within source will automatically be generated. By default, details are added as a primary source. To override this, specify the type</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/metadata_add_source_doi.html">metadata_add_source_doi</a></span>(dataset_id, doi, <span class="dt">type=</span><span class="st">"secondary"</span>)</a></code></pre></div>
<p>Alternatively, if you have reference details saved in a bibtex file called <code>myref.bib</code> you can use the function</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/metadata_add_source_doi.html">metadata_add_source_doi</a></span>(dataset_id, <span class="dt">file =</span> <span class="st">"myref.bib"</span>)</a></code></pre></div>
<p>(These options require the package <a href="https://github.com/ropensci/rcrossref">rcrossref</a> and <a href="https://github.com/ropensci/RefManageR/">RefManageR</a> to be installed.)</p>
</div>
<div id="adding-people" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-people" class="anchor"></a>Adding people</h3>
<p>The function <code>metadata_create_template</code> creates a template for entering details about people, which you can then edit manually.</p>
</div>
<div id="custom-r-code" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-r-code" class="anchor"></a>Custom R code</h3>
<p>Occasionally all the changes we want to make to dataset may not fit into the prescribed workflow used in Austraits. For example, we assume each trait has a single unit. But there are a few datasets where data on different rows have different units. So we want to make to make some custom modifications to this particular dataset before the common pipeline of operations gets applied. To make this possible, the workflow allows for some custom R code to be run as a first step in the processing pipeline. That pipeline (in the function <a href="https://github.com/traitecoevo/austraits/blob/master/R/steps.R"><code>load_study</code></a>) looks like this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">  data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">    </span><span class="kw">read_csv</span>(filename_data_raw, <span class="dt">col_types =</span> <span class="kw">cols</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">    </span><span class="kw">custom_manipulation</span>(metadata[[<span class="st">"config"</span>]][[<span class="st">"custom_R_code"</span>]])() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">    </span><span class="kw">parse_data</span>(dataset_id, metadata) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="st">    </span>...</a></code></pre></div>
<p>Note the second line. After loading the csv file, we can apply some Custom R code small manipulations to the dataframe before processing it. Custom R code is valid R code, but written inside the <code>metadata.yml</code> file. While developing this, you’ll want to test your code. This can be achieved by running the function</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="../reference/metadata_check_custom_R_code.html">metadata_check_custom_R_code</a></span>(dataset_id)</a></code></pre></div>
<p>which returns a data frame, showing how the datasets looks after being manipulated.mes</p>
</div>
</div>
<div id="custom_R_code" class="section level2">
<h2 class="hasAnchor">
<a href="#custom_R_code" class="anchor"></a>Adding custom R code into metadata.yml</h2>
<p>Occasionally all the changes we want to make to dataset may not fit into the prescribed workflow used in AusTraits. As an example, for <code>Blackman_2010</code> we want to combine two columns to create an appropriate site variable. So we want to make to make some custom modifications to this particular dataset before the common pipeline of operations gets applied. To make this possible, the workflow allows for some custom R code to be run as a first step in the processing pipeline. That pipeline (in the function <a href="https://github.com/traitecoevo/austraits/blob/master/R/steps.R"><code>load_study</code></a>) looks like:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">  data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">    </span><span class="kw">read_csv</span>(filename_data_raw, <span class="dt">ol_types =</span> <span class="kw">cols</span>(), <span class="dt">guess_max =</span> <span class="dv">100000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">    </span><span class="kw">custom_manipulation</span>(metadata[[<span class="st">"config"</span>]][[<span class="st">"custom_R_code"</span>]])() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">    </span><span class="kw">parse_data</span>(dataset_id, metadata) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="st">    </span>...</a></code></pre></div>
<p>Note the second line. This is where the custom code get’s applied, right after the file is loaded.</p>
<p>Here is the code that was included in <a href="https://github.com/traitecoevo/austraits/blob/master/data/Blackman_2010/metadata.yml">data/Blackman_2010/metadata.yml</a> under <code>custom_R_code</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">    <span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(site <span class="op">==</span><span class="st"> "Mt Field"</span> <span class="op">&amp;</span><span class="st"> </span>habitat <span class="op">==</span><span class="st"> "Montane rainforest"</span>, <span class="st">"Mt Field_wet"</span>, site),</a>
<a class="sourceLine" id="cb11-3" title="3">    <span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(site <span class="op">==</span><span class="st"> "Mt Field"</span> <span class="op">&amp;</span><span class="st"> </span>habitat <span class="op">==</span><span class="st"> "Dry sclerophyll"</span>, <span class="st">"Mt Field_dry"</span>, site)</a>
<a class="sourceLine" id="cb11-4" title="4">    )</a></code></pre></div>
<p>This is the finished solution. This code gets run everytime we rebuild the Blackman_2010 dataset.</p>
<p>To get there we did as follows. Generally, the custom R ccode should</p>
<ul>
<li>assume a single object called <code>data</code>, and apply whatever fixes are needed</li>
<li>use functions from the packages <a href="https://dplyr.tidyverse.org">dplyr</a> or <a href="https://tidyr.tidyverse.org"><code>tiydr</code></a>, like <code>mutate</code>, <code>rename</code>, etc, and otherwise avoid extrenal packages</li>
<li>be fully self contained (we’re not going to use any of the other remake machinery here)</li>
<li>use pipes to weave together a single statement, where possible. (Otherwise you’ll need a semi colons <code>;</code> at the end of each statement).</li>
</ul>
<p>First, load an object called <code>data</code> to play with, as if you were building this dataset object:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(readr)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(yaml)</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4">data &lt;-<span class="st"> </span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"data"</span>, <span class="st">"Blackman_2010"</span>, <span class="st">"data.csv"</span>), <span class="dt">col_types =</span> <span class="kw"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span>(<span class="dt">.default =</span> <span class="st">"c"</span>))</a>
<a class="sourceLine" id="cb12-5" title="5">data</a></code></pre></div>
<p>Second, write your code to manipulate data, like the example above.</p>
<p>Third, once you have some working code, you then want to add it into your yml file under a group <code>config</code> -&gt; <code>custom_R_code</code>.</p>
<p>Finally, check it works. Let’s assume you added it in. The function <code>metadata_check_custom_R_code</code> loads the data and applies the custom R code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/metadata_check_custom_R_code.html">metadata_check_custom_R_code</a></span>(<span class="st">"Blackman_2010"</span>)</a></code></pre></div>
<div id="defining-traits" class="section level3">
<h3 class="hasAnchor">
<a href="#defining-traits" class="anchor"></a>Defining traits</h3>
<p>Add traits</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="../reference/metadata_add_traits.html">metadata_add_traits</a></span>(dataset_id)</a></code></pre></div>
<!-- TODO: You will be asked to indicate the columns you wish to keep as distinct traits -->
</div>
<div id="site-details" class="section level3">
<h3 class="hasAnchor">
<a href="#site-details" class="anchor"></a>Site details</h3>
<p>Add sites details</p>
<p>This function assumes you have site details stored in wide format, in R:</p>
<!-- TODO: need to indicate that the following code needs to be run with the assignment site_data for the previous code to work. -->
<pre><code>#&gt; # A tibble: 2 x 6
#&gt;   site_name description `elevation (m)` `latitude (deg)` `longitude (deg…
#&gt;   &lt;chr&gt;     &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
#&gt; 1 Atherton  Tropical r…             800            -17.1             146.
#&gt; 2 Cape Tri… Complex me…              25            -16.1             145.
#&gt; # … with 1 more variable: `rainfall (mm)` &lt;dbl&gt;</code></pre>
<p>If your data is in a file, you’ll need to read it in first.</p>
</div>
<div id="using-substitutions" class="section level3">
<h3 class="hasAnchor">
<a href="#using-substitutions" class="anchor"></a>Using substitutions</h3>
<p>Substitutions can be added by running:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="../reference/metadata_add_substitution.html">metadata_add_substitution</a></span>(dataset_id, trait_name, find, replace)</a></code></pre></div>
<p>where <code>find</code> is the trait value used in the data.csv file and <code>replace</code> is the trait value supported by Austraits.</p>
</div>
<div id="update-taxonomy" class="section level3">
<h3 class="hasAnchor">
<a href="#update-taxonomy" class="anchor"></a>Update taxonomy</h3>
<p>We’ve implemented code to semi-automate the checking of names using the R package <a href="https://cran.r-project.org/web/packages/Taxonstand/index.html">Taxonstand</a> (for more documentation see <a href="https://www.rdocumentation.org/packages/Taxonstand/versions/2.1/topics/TPL">here</a>). To generate a suggested name change for a specific study run:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../reference/metadata_check_taxa.html">metadata_check_taxa</a></span>(<span class="st">"Westoby_2014"</span>)</a></code></pre></div>
<p>If TaxonStand finds taxonomic changes it will add the relevant lines of code directly to the metadata.yml file.</p>
<p>TaxonStand has been configured in the above function to only permit relatively certain changes (e.g. with a minor change to spelling or known synonym).</p>
<p>There are additional arguments you can add for the function <code>metadata_check_taxa</code> including: - <code>update</code> where the default is TRUE, meaning changes found will be added to the <code>metadata.yml</code> file - <code>typos</code> where the default is FALSE, meaning typos will not be corrected - <code>diffchar</code> which indicates the number of characters that can be different for a typo-match. Here the default is two.</p>
<p>Therefore, if you want the function <code>metadata_check_taxa</code> to correct 1 and 2 character typos, run the function as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="../reference/metadata_check_taxa.html">metadata_check_taxa</a></span>(<span class="st">"Westoby_2014"</span>, <span class="dt">typos=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>If TaxonStand fails to find a suitable alignment, and you have identified one yourself, you can add it to the metadata by running</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="../reference/metadata_add_taxnomic_change.html">metadata_add_taxnomic_change</a></span>(study, find, replace, reason)</a></code></pre></div>
<p>For any plants that are only identified to genus, make sure the genus name is the first part of the name given; this will ensure its genus and family is recorded appropriately. I.e. use ‘Acacia sp. long leaf’, not ‘long leaf Acacia’.</p>
</div>
</div>
<div id="running_tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running_tests" class="anchor"></a>Running tests</h2>
<p>You can also run some automated tests to ensure the dataset meets required set up. The tests run through a collection of pre-specified checks on the files for each study. The output alerts you to possible issues needing to be fixed, by comparing the data in the files with expected structure and allowed values, as specified in the definitions. NBy far the most common error is that there are unusual text characters, for example often special hyphen’s, quote symbols, plus-minus symbols. These should be replaced by simple text equivalents.</p>
<p>To run the tests, the variable <code>dataset_ids</code> must be defined in the global namespace, containing a vector of ids to check. For example</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># load relevant functions</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"R/setup.R"</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co"># Tests run test on one study</span></a>
<a class="sourceLine" id="cb20-5" title="5">dataset_ids &lt;-<span class="st"> "Bragg_2002"</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="kw"><a href="../reference/austraits_run_tests.html">austraits_run_tests</a></span>()</a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co"># Tests run test on all studies</span></a>
<a class="sourceLine" id="cb20-9" title="9">dataset_ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="st">"data"</span>)</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="kw"><a href="../reference/austraits_run_tests.html">austraits_run_tests</a></span>()</a></code></pre></div>
</div>
<div id="reports" class="section level2">
<h2 class="hasAnchor">
<a href="#reports" class="anchor"></a>Reports / quality checks</h2>
<div id="study-specific-reports" class="section level3">
<h3 class="hasAnchor">
<a href="#study-specific-reports" class="anchor"></a>Study specific reports</h3>
<p>To enable better quality checks we have code to generate a report on the data in each study.</p>
<p>(Reports are written in <a href="https://rstudio.github.io/rmarkdown/">Rmarkdown</a> and generated via the <a href="https://cran.r-project.org/web/packages/knitr/">knitr</a> package. The template is stored in <code>scripts/report_study.html</code>).</p>
<p>To generate a report for a particular study:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">austraits &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"export/data/austraits.rds"</span>)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"R/report_utils.R"</span>)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw"><a href="../reference/build_study_report.html">build_study_report</a></span>(<span class="st">"Wright_2002"</span>)</a></code></pre></div>
<p>To generate a report for a collection of studies:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../reference/build_study_reports.html">build_study_reports</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Falster_2005_1"</span>, <span class="st">"Wright_2002"</span>))</a></code></pre></div>
<p>Or for all studies:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="../reference/build_study_reports.html">build_study_reports</a></span>()</a></code></pre></div>
<p>Both functions <code>build_study_report</code> &amp; <code>build_study_reports</code> can accept an additional argument <code>overwrite=TRUE</code>, to overwrite existing reports if they exist. Eg.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="../reference/build_study_report.html">build_study_report</a></span>(<span class="st">"Wright_2002"</span>, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="check-excluded-data" class="section level3">
<h3 class="hasAnchor">
<a href="#check-excluded-data" class="anchor"></a>Check excluded data</h3>
<p>One thing to check in particular, is any data have been excluded. These are available in the frame <code>excluded_data</code>.</p>
<p>Possible reasons for excluding that value include:</p>
<ul>
<li>
<em>Missing value</em>: Value was missing</li>
<li>
<em>Missing unit conversion</em>: Value was present but appropriate unit conversion was missing -&gt; you need to add it to the file <code>config/unit_conversions.csv</code>
</li>
<li>
<em>Unsupported trait</em>: <code>trait_name</code> not listed in <code>config/definitions.yml</code>, under <code>traits</code>
</li>
<li>
<em>Unsupported trait value</em>: For categorical traits, <code>value</code> for trait not included for that trait in <code>config/definitions.yml</code>
</li>
<li>
<em>Value does not convert to numeric</em>: Is there a strange character in the file preventing easy conversion?</li>
<li>
<em>Value out of allowable range</em>: Converted value falls outside of the allowable range specified for that trait in `config/definitions.ym</li>
</ul>
<p>For your dataset, you can investigate why you have excluded data as follows.</p>
<p>Look at everything</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">austraits<span class="op">$</span>excluded_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(dataset_id<span class="op">==</span><span class="st">"ANBG_2019"</span>)</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#&gt; # A tibble: 2,032 x 12</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">#&gt;    error dataset_id species_name site_name context_name observation_id</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">#&gt;  1 Unsu… ANBG_2019  Abelmoschus… site_at_… &lt;NA&gt;         ANBG_2019_0001</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#&gt;  2 Unsu… ANBG_2019  Abelmoschus… site_at_… &lt;NA&gt;         ANBG_2019_0001</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">#&gt;  3 Unsu… ANBG_2019  Abutilon ot… site_at_… &lt;NA&gt;         ANBG_2019_0010</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">#&gt;  4 Unsu… ANBG_2019  Abutilon ot… site_at_… &lt;NA&gt;         ANBG_2019_0010</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">#&gt;  5 Unsu… ANBG_2019  Acacia acin… site_at_… &lt;NA&gt;         ANBG_2019_0012</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">#&gt;  6 Unsu… ANBG_2019  Acacia acin… site_at_… &lt;NA&gt;         ANBG_2019_0012</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co">#&gt;  7 Unsu… ANBG_2019  Acacia acum… site_at_… &lt;NA&gt;         ANBG_2019_0017</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="co">#&gt;  8 Unsu… ANBG_2019  Acacia acum… site_at_… &lt;NA&gt;         ANBG_2019_0017</span></a>
<a class="sourceLine" id="cb25-14" title="14"><span class="co">#&gt;  9 Unsu… ANBG_2019  Acacia adsu… site_at_… &lt;NA&gt;         ANBG_2019_0019</span></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="co">#&gt; 10 Unsu… ANBG_2019  Acacia adsu… site_at_… &lt;NA&gt;         ANBG_2019_0019</span></a>
<a class="sourceLine" id="cb25-16" title="16"><span class="co">#&gt; # … with 2,022 more rows, and 6 more variables: trait_name &lt;chr&gt;, value &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="co">#&gt; #   unit &lt;chr&gt;, value_type &lt;fct&gt;, replicates &lt;chr&gt;, original_name &lt;chr&gt;</span></a></code></pre></div>
<p>If you want to inspect this more closely, just pass it into <code>View</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">austraits<span class="op">$</span>excluded_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(dataset_id<span class="op">==</span><span class="st">"ANBG_2019"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/View.html">View</a></span>()</a></code></pre></div>
<p>How many of each type:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">austraits<span class="op">$</span>excluded_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(dataset_id<span class="op">==</span><span class="st">"ANBG_2019"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">pull</span>(error) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>()</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">#&gt; .</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#&gt;                     Missing value                 Unsupported trait </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#&gt;                                36                              1986 </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#&gt;           Unsupported trait value Value does not convert to numeric </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#&gt;                                 1                                 9</span></a></code></pre></div>
<p>How many of each type by trait:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">austraits<span class="op">$</span>excluded_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(dataset_id<span class="op">==</span><span class="st">"ANBG_2019"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">select</span>(trait_name, error) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>()</a>
<a class="sourceLine" id="cb28-5" title="5"><span class="co">#&gt;                        error</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co">#&gt; trait_name              Missing value Unsupported trait Unsupported trait value</span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co">#&gt;   germination_treatment             0                 0                       1</span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co">#&gt;   LengthSample                      0               957                       0</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">#&gt;   seed_mass                         0                 0                       0</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">#&gt;   seed_shape                       36                 0                       0</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">#&gt;   WidthSample                       0              1029                       0</span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="co">#&gt;                        error</span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="co">#&gt; trait_name              Value does not convert to numeric</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co">#&gt;   germination_treatment                                 0</span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co">#&gt;   LengthSample                                          0</span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co">#&gt;   seed_mass                                             9</span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co">#&gt;   seed_shape                                            0</span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="co">#&gt;   WidthSample                                           0</span></a></code></pre></div>
<p>View records that aren’t missing values</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">austraits<span class="op">$</span>excluded_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(dataset_id<span class="op">==</span><span class="st">"ANBG_2019"</span>, error <span class="op">!=</span><span class="st">"Missing value"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/View.html">View</a></span>()</a></code></pre></div>
</div>
<div id="clean-the-formatting-of-metadata-yml" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-the-formatting-of-metadata-yml" class="anchor"></a>Clean the formatting of metadata.yml</h3>
<p>Before finishing your contribution, you should read &amp; write the file <code>metadata.yml</code>, as this may change the way the text is formatted. Doing this now, prevents any unnecessary changes in the future.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"data"</span>, dataset_id, <span class="st">"metadata.yml"</span>)</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html">read_yaml</a></span>(f) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/write_yaml.html">write_yaml</a></span>(f)</a></code></pre></div>
</div>
</div>
</div>
<div id="working-with-our-github-repository" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-our-github-repository" class="anchor"></a>Working with our GitHub repository</h1>
<p>By far our preferred way of contributing is for you to contribute files directly into the repository and then send a <a href="https://help.github.com/articles/using-pull-requests/">pull request</a> with you input. You can do this by</p>
<ul>
<li>(for approved maintainers of austraits.build) Creating a branch, or</li>
<li>(for others) forking the database in github</li>
</ul>
<p>In short,</p>
<ol style="list-style-type: decimal">
<li>Create a Git branch for your new work, either within the AusTraits repo (if you are an approved contributor) or as a <a href="https://help.github.com/en/github/getting-started-with-github/fork-a-repo">fork of the repo</a>.</li>
<li>Make commits and push these up onto the branch.</li>
<li>Make sure everything runs fine before you send a pull request.</li>
<li>When you’re ready to merge in the new features,</li>
</ol>
<p>Before you make a substantial pull request, you should always <a href="https://github.com/traitecoevo/austraits.build/issues">file an issue</a> and make sure someone from the team agrees that it’s worth pursuing. a problem. If you’ve found a bug, create an associated issue and illustrate the bug with a minimal <a href="https://www.tidyverse.org/help/#reprex">reprex</a> illustrating the issue.</p>
<p>If this is not possible, you could email the relevant files (see above) to the Austraits email: <a href="mailto:austraits.database@gmail.com" class="email">austraits.database@gmail.com</a></p>
<div id="merging-a-pull-request" class="section level2">
<h2 class="hasAnchor">
<a href="#merging-a-pull-request" class="anchor"></a>Merging a pull request</h2>
<p>There are multiple ways to merge a pull request, including using GitHub’s built-in options for merging and squashing. When merging a PR, we ideally want</p>
<ul>
<li>a single commit</li>
<li>attributing the work to the original author</li>
<li>to run various checks along the way</li>
</ul>
<p>There’s two ways to do this. For both you need to be an approved maintainer.</p>
<div id="merging-in-your-own-pr" class="section level3">
<h3 class="hasAnchor">
<a href="#merging-in-your-own-pr" class="anchor"></a>Merging in your own PR</h3>
<p>You can merge in your own PR after you’ve had someone else review it.</p>
<ol style="list-style-type: decimal">
<li>Send the PR</li>
<li>Tag someone to review</li>
<li>Once ready, merge into main choosing “Squash &amp; Merge”, using an informative commit message.</li>
</ol>
</div>
<div id="merging-someone-elses-pr" class="section level3">
<h3 class="hasAnchor">
<a href="#merging-someone-elses-pr" class="anchor"></a>Merging someone else’s PR</h3>
<p>When merging in someone else’s PR, the built-in options aren’t ideal. as they either take all of the commits on a branch (ugh, messy), OR make the commit under the name of the person merging the request.</p>
<p>The workflow below describes how to merge a pull request from the command line, with a single commit &amp; attributing the work to the original author. Lets assume a branch of name <code>Smith_1995</code>.</p>
<p>First from the master branch in the repo, run the following:</p>
<pre><code>git merge --squash origin/Smith_1995</code></pre>
<p>Then in R</p>
<p>Now back in the terminal</p>
<pre><code>git add .
git commit</code></pre>
<p>Add a commit message, referencing relevant pull requests and issues, e.g.</p>
<pre><code>Smith_1995: Import new data

For #224, closes #286</code></pre>
<p>And finally, amend the commit author, to reference the person who did all the work!</p>
<pre><code>git commit --amend --author "XXX &lt;XXX@gmail.com&gt;"</code></pre>
</div>
</div>
<div id="commit-messages" class="section level2">
<h2 class="hasAnchor">
<a href="#commit-messages" class="anchor"></a>Commit messages</h2>
<p>XXXXXX Informative commit messages are ideal. Where possible, these should link to</p>
</div>
<div id="version-updating-making-a-new-release" class="section level2">
<h2 class="hasAnchor">
<a href="#version-updating-making-a-new-release" class="anchor"></a>Version updating &amp; Making a new release</h2>
<p>Releaes of the dataset are snapshots that are archived and available for use.</p>
<p>We use semantic versioning to label our versions. As discussed in <a href="http://doi.org/:%2010.1093/gigascience/giz035">Falster et al 2019</a>, semantic versioning can apply to datasets as well as code.</p>
<p>The version number will have 3 components for actual relases, and 4 for development versions. The structure is <code>major.minor.patch.dev</code>, where <code>dev</code> is at least 9000. The <code>dev</code> component provides a visual signal that this is a development version. So, if the current version is 0.9.1.9000, the release be 0.9.2, 0.10.0 or 1.0.0.</p>
<p>Our approach to incrmenetaing version numbers is</p>
<ul>
<li>
<code>major</code>: increment when you make changes to the structure that are likely incompatible with any code written to work with previous versions.</li>
<li>
<code>minor</code>: increment to communicate any changes to the structure that are likely to be compatible with any code written to work with the previous versions (i.e., allows code to run without error). Such changes might involve adding new data within the existing structure, so that the previous dataset version exists as a subset of the new version. For tab- ular data, this includes adding columns or rows. On the other hand, removing data should constitute a major version because records previously relied on may no longer exist.</li>
<li>
<code>patch</code>: Increment to communicate correction of errors in the actual data, without any changes to the structure. Such changes are unlikely to break or change analyses written with the previous version in a substantial way.</li>
</ul>
<p><img src="../docs/figures/giz035fig2.png"></p>
<p><strong>Figure:</strong> Semantic versioning communicates to users the types of changes that have occurred between successive versions of an evolving dataset, using a tri-digit label where increments in a number indicate major, minor, and patch-level changes, respectively. From <a href="http://doi.org/:%2010.1093/gigascience/giz035">Falster et al 2019</a>, (CC-BY).</p>
<p>The process of making a release is as follows. Note that correpsonding releases and versions are needed in both <code>austraits</code> and <code>austraits.build</code>:</p>
<ol style="list-style-type: decimal">
<li><p>Update the version number in the DECRIPTION file, using `</p></li>
<li><p>Compile <code>austraits.build</code>.</p></li>
<li><p>Update the documentation.</p></li>
<li><p>Commit and push to github.</p></li>
<li><p>Make a release on github, adding version number</p></li>
<li><p>Prepare for the next version by updating version numbers.</p></li>
</ol>
</div>
</div>
<div id="other" class="section level1">
<h1 class="hasAnchor">
<a href="#other" class="anchor"></a>Other</h1>
<div id="file-types" class="section level2">
<h2 class="hasAnchor">
<a href="#file-types" class="anchor"></a>File types</h2>
<div id="csv" class="section level3">
<h3 class="hasAnchor">
<a href="#csv" class="anchor"></a>CSV</h3>
<p>A comma-separated values (CSV) file is a delimited text file that uses a comma to separate values. Each line of the file is a data record. Each record consists of one or more fields, separated by commas. This is a comma format for storing tables of data in a simple text file. You can edit it an Excel or in a text editor.For more, see <a href="https://en.wikipedia.org/wiki/Comma-separated_values">here</a>.</p>
</div>
<div id="yaml" class="section level3">
<h3 class="hasAnchor">
<a href="#yaml" class="anchor"></a>YAML files</h3>
<p>The <code>yml</code> file extension (pronounced “YAML”) <a href="https://en.wikipedia.org/wiki/YAML">is a type structured data file</a>, that is both human and machine readable. You can edit it any text editor, or also in Rstudio. Generally, yml is used in situations where a table does not suit because of variable lengths and or nested structures. It has the advantage over a spreadsheet in that the nested “headers” can have variable numbers of categories. The data under each of the hierarchical headings are easily extracted by R.</p>
</div>
</div>
<div id="extracting-data-from-pdf-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-data-from-pdf-tables" class="anchor"></a>Extracting data from PDF tables</h2>
<p>If you encounter a PDF table of data and need to extract values, this can be achieved with the <a href="https://github.com/tabulapdf/tabula-java/"><code>tabula-java</code> tool</a>. There’s actually an R wrapper (called <a href="https://github.com/ropensci/tabulizer"><code>tabulizer</code></a>), but we haven’t succeeded in getting this running. However, it’s easy enough to run the java tool at the command line on OSX.</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://github.com/tabulapdf/tabula-java/releases">Download latest release of <code>tabula-java</code></a> and save the file in your path</p></li>
<li><p>Run</p></li>
</ol>
<pre><code>java -jar tabula-1.0.3-jar-with-dependencies.jar my_table.pdf -o my_data.csv</code></pre>
<p>This should output the data from the table in <code>my_table.pdf</code> into the csv <code>my_data.csv</code></p>
<ol start="3" style="list-style-type: decimal">
<li>Clean up in Excel. check especially for correct locations of white spaces.</li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li>
<a href="#inputting-data">Inputting data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#constructing-the-data-csv-file">Constructing the <code>data.csv</code> file</a></li>
      <li><a href="#constructing-the-metadata-yml-file">Constructing the <code>metadata.yml</code> file</a></li>
      <li><a href="#custom_R_code">Adding custom R code into metadata.yml</a></li>
      <li><a href="#running_tests">Running tests</a></li>
      <li><a href="#reports">Reports / quality checks</a></li>
      </ul>
</li>
      <li>
<a href="#working-with-our-github-repository">Working with our GitHub repository</a><ul class="nav nav-pills nav-stacked">
<li><a href="#merging-a-pull-request">Merging a pull request</a></li>
      <li><a href="#commit-messages">Commit messages</a></li>
      <li><a href="#version-updating-making-a-new-release">Version updating &amp; Making a new release</a></li>
      </ul>
</li>
      <li>
<a href="#other">Other</a><ul class="nav nav-pills nav-stacked">
<li><a href="#file-types">File types</a></li>
      <li><a href="#extracting-data-from-pdf-tables">Extracting data from PDF tables</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Falster, Rachael Gallagher, Elizabeth Wenk, Ian Wright, Sam Andrew, Caitlin Baxter, ARDC, ARC.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
