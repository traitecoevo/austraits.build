
entity_type:
    description: &entity_type A categorical variable describing the entity for which values represent.
    type: categorical
    values:
      individual: Value comes from a single individual
      population: Value represents a summary statsitic from multiple individuals at a single site
      metapopulation: Value represents a summary statsitic from individuals of the taxon across multiple sites
      species: Values the mean observed for a taxon across its range or, in this particular dataset, as estimated by an expert based on their knowledge of the taxon. Data fitting this category include estimates from floras that represent a taxon's entire range and values for categorical variables obtained from a reference book, or identified by an expert.
  
  value_type:
    description: &value_type A categorical variable describing the type of value recorded.
    type: categorical
    values:
      raw: Value recorded for an entity (individual).
      minimum: Value is the minimum of values recorded for an entity.
      mean: Value is the median of values recorded for an entity.
      median: Value is the  median of values recorded for an entity.
      maximum: Value is the maximum of values recorded for an entity.
      mode: Value is the mode of values recorded for an entity.
      range: Value is a range of values recorded for an entity.
      bin: Value for an entity falls within specified limits.
      unknown: Not currently known.
  
  basis_of_value: 
    descritpion: &basis_of_value A categorical value describinb the basis of the recorded value.
    type: categorical 
    values:
      measurement: Value is the minimum of measurements on multiple individuals of the taxon across multiple sites.
      expert_score: Estimated by an expert based on their knowledge of the taxon.
      model_derived: Value is dereived from a statsitcial mdoel, for example via gap-filling.
      unknown: Not currently known.

#-------------------------------------------------------------
# A key describing the structure of the compiled `AusTraits` dataset

austraits:
  description: The compiled `AusTraits` dataset.
  type: list
  elements:
    traits:
      description: A table containing measurements of plant traits.
      type: table
      elements:
        dataset_id: &dataset_id Primary identifier for each study contributed to AusTraits; most often these are scientific papers, books, or online resources. By default this should be the name of the first author and year of publication, e.g. `Falster_2005`.
        taxon_name: &taxon_name Whenever possible, this field indicates the current accepted scientific name of a taxon, per the Australian Plant Census (APC). Alternatively, `taxon_name` can indicate an alignment with a name included in the comprehensive Australian Plant Names Index (APNI), but not currently marked as accepted in APC, or a name that cannot be aligned to available lists of Australian plant names.
        site_name: &site_name Name of the site where the individual was sampled. Cross-references between similar columns in `sites` and `traits`.
        context_name: &context_name Name of contextual senario where the individual was sampled. Cross-references between similar columns in `contexts` and `traits`.
        individual_id: &individual_id A unique identifier for an individual plant. Often each row of data represents an individual, but in some datasets trait data collected on a single individual is presented across multiple rows of data, such as if the same trait is measured using different methods or the same individual is measured repeatedly across time. 
        population_id: &population_id A unique identifier for a population. As used in AusTraits, this is often a true biological population (that is, a site), but the term `population` is also used to capture a single experimental treatment.
        entity_id: &entity_id A unique identifier that encodes the species, population, and/or individual that is connected to a trait value. A species-level trait value will have an entity_id that only includes a species component. A population-level trait value will have an entity_id that includes both species and population components. And an individual-level trait value will have an entity_id that includes species, population, and individual components.  
        observation_id: &observation_id A unique identifier for the observation, important for joining traits coming from the same `observation_id` until `entity_id` is created later in the workflow. For wide datasets, unless a column is specified under `individual_id` , these are assigned automatically based on the `dataset_id` and row number of the raw data.
        observation_number: &observation_number Observation number defaults to 1, unless it is manually added as a column or to individual traits
        trait_name: &trait_name Name of the trait sampled. Allowable values specified in the table `definitions`.
        value: &value Measured value.
        unit: &units Units of the sampled trait value after aligning with AusTraits standards.
        collection_date: &collection_date Date sample was taken, in the format `yyyy-mm-dd`, `yyyy-mm` or `yyyy`, depending on the resoluton specified.
        entity_type: *entity_type
        value_type: *value_type
        basis_of_value: *basis_of_value
        replicates: &replicates Number of replicate measurements that comprise the data points for the trait for each measurement. A numeric value (or range) is ideal and appropriate if the value type is a `mean`, `median`, `min` or  `max`. For these value types, if replication is unknown the entry should be `unknown`. If the value type is `raw_value` the replicate value should be 1. If the value type is `expert_mean`, `expert_min`, or `expert_max` the replicate value should be `.na`.
        collection_type: &collection_type A field to indicate where the majority of plants on which traits were measured were collected -  in the `field`, `lab`, `glasshouse`, `botanical collection`, or `literature`. The latter should only be used when the data were sourced from the literature and the collection type is unknown.
        sample_age_class: &sample_age_class A field to indicate if the study was completed on `adult` or `juvenile` plants.
        measurement_remarks: &measurement_remarks Comments or notes accompanying the trait measurement.
        method_number: &method_number Method number defaults to 1, unless it is manually added to individual traits. It is used to flag when a trait is read into AusTraits multiple times, with different methods used for each entry. 
        original_name: &orginal_name Name given to taxon in the original data supplied by the authors.
    sites:
      description: A table containing observations of site characteristics associated with information in `traits`. Cross referencing between the two dataframes is possible using combinations of the variables `dataset_id`, `site_name`.
      type: table
      elements:
        dataset_id: *dataset_id
        site_name: *site_name
        site_property: The site characteristic being recorded. The name should include units of measurement, e.g. `MAT (C)`. Ideally we have at least the following variables for each site, `longitude (deg)`, `latitude (deg)`, `description`.
        value: *value
    contexts:
      description: A table containing observations of contextual characteristics associated with information in `traits`. Cross referencing between the two dataframes is possible using combinations of the variables `dataset_id`, `context_name`.
      type: table
      elements:
        dataset_id: *dataset_id
        context_name: *context_name
        context_property: The contextual characteristic being recorded. Name should include units of measurement, e.g. `CO2 concentration (ppm)`.
        value: *value
    methods:
      description: A table containing details on methods with which data were collected, including time frame and source. Cross referencing with the `traits` table is possible using combinations of the variables `dataset_id`, `trait_name`.
      type: table
      elements:
        dataset_id: *dataset_id
        trait_name: *trait_name
        methods: &methods A textual description of the methods used to collect the trait data. Whenever available, methods are taken near-verbatim from the referenced source. Methods can include descriptions such as 'measured on botanical collections', 'data from the literature', or a detailed description of the field or lab methods used to collect the data.
        description: &description A 1-2 sentence description of the purpose of the study.
        sampling_strategy: &sampling_strategy A written description of how study sites were selected and how study individuals were selected. When available, this information is lifted verbatim from a published manuscript. For botanical collections, this field ideally indicates which records were 'sampled' to measure a specific trait.
        source_primary_key: Citation key for the primary source in `sources`. The key is typically formatted as `Surname_year`.
        source_primary_citation: Citation for the primary source. This detail is generated from the primary source in the metadata.
        source_secondary_key: Citation key for the secondary source in `sources`.  The key is typically formatted as `Surname_year`.
        source_secondary_citation: Citations for the secondary source. This detail is generated from the secondary source in the metadata.
        data_collectors: &data_collectors The person (people) leading data collection for this study.
        assistants: &assistants Names of additional people who played a more minor role in data collection for the study.
        austraits_curators: &austraits_curators Names of AusTraits team member(s) who contacted the data collectors and added the study to the AusTraits repository.
    excluded_data:
      description: A table of data that did not pass quality tests and so were excluded from the master dataset. The structure is identical to that presented in the `traits` table, only with an extra column called `error` indicating why the record was excluded. Common reasons are missing_unit_conversions, missing_value, and unsupported_trait_value.
      type: table
      elements:
        error: Indicating why the record was excluded. Common reasons are missing_unit_conversions, missing_value, and unsupported_trait_value.
        dataset_id: *dataset_id
        taxon_name: *taxon_name
        site_name: *site_name
        context_name: *context_name
        observation_id: *observation_id
        trait_name: *trait_name
        value: *value
        unit: *units
        collection_date: *collection_date
        value_type: *value_type
        replicates: *replicates
        collection_type: *collection_type
        sample_age_class: *sample_age_class
        measurement_remarks: *measurement_remarks
        original_name: *orginal_name
    taxonomic_updates:
      description: A table of all taxonomic changes implemented in the construction of AusTraits. Changes are determined by comparing the originally submitted taxon name against the APC (Australian Plant Census) and APNI (Australian Plant Names Index). Cross referencing with the `traits` table is possible using combinations of the variables `dataset_id` and `taxon_name`.
      type: table
      elements:
        dataset_id: *dataset_id
        original_name: *orginal_name
        cleaned_name: Name of the taxon after implementing automated syntax standardisation and spelling changes as well as manually encoded syntax alignments for this taxon in the metadata file for the corresponding `dataset_id`.
        taxonIDClean: The APC identifier for the `cleaned_name` of the taxon (for taxa designated as current for APC) or APNI identifier (for taxa included in APNI, but unplaced for APC).
        taxonomicStatusClean: The APC taxonomic status for the `cleaned_name` of the taxon identified by `taxonIDClean`.
        alternativeTaxonomicStatusClean: The APC taxonomic status of alternative APC records with the name `cleaned_name`.
        acceptedNameUsageID: The APC identifier for the accepted name (`taxon_name`) for a taxon; this is different from `taxonIDClean` if `taxonomicStatusClean` is not `accepted`.
        taxon_name: *taxon_name
    taxa:
      description: A table containing details on taxa associated with information in `traits`. This information has been sourced from the APC (Australian Plant Census) and APNI (Australian Plant Names Index) and is released under a CC-BY3 license. Cross referencing between the two dataframes is possible using combinations of the variable `taxon_name`.
      type: table
      elements:
        taxon_name: *taxon_name
        source: Source of taxonomic information, either APC or APNI.
        acceptedNameUsageID: The identifier of the accepted concept in APC for this taxon name.
        scientificNameAuthorship: Authority for the taxon indicated under `taxon_name`; applicable for most taxa in APC.
        taxonRank: Rank of the taxon.
        taxonomicStatus: "Taxonomic status of the taxon. `accepted` indicates the taxon name is designated as `current` in APC, a taxonomy endorsed by the Council of Heads of Australasian Herbaria. Alternate statuses are: `unplaced` indicating that the taxon name is included in APNI but has yet to be reviewed for inclusion/exclusion as a current name (or synonym) for APC; `genus_known` indicating the taxon name can only be aligned to the genus level; `family_known` indicating the taxon name can only be aligned to the family level, and `unknown` indicating a taxon name submitted to AusTraits that cannot be aligned at any level."
        family: Family of the taxon.
        taxonDistribution: Known distribution of the taxon, by Australian state.
        ccAttributionIRI: Source of taxonomic information (for taxa designated as current for APC) or name information (for taxa included in APNI, but unplaced  for APC).
        genus: Genus of the taxon.
    contributors:
      description: A table of people contributing to each study.
      type: table
      elements:
        dataset_id: *dataset_id
        last_name: Last name of the data collector
        given_name: Given names of the data collector
        ORCID: ORCID of the data collector
        affiliation: Last known institution or affiliation
        additional_role: Additional roles of data collector, mostly contact person
    sources:
      description: Bibtex entries for all primary and secondary sources in the compilation.
      type: list
    trait_definitions:
      description: A copy of the definitions for all tables and terms. Information included here was used to process data and generate any documentation for the study.
      type: categorical
      value: A structured yaml file, represented as a list in R. See file `config/traits.yaml` for more details.
    schema:
      description: A copy of the schema for all tables and terms. Information included here was used to process data and generate any documentation for the study.
      type: categorical
      value: A structured yaml file, represented as a list in R.
    build_info:
      description: A description of the computing environment used to create this version of the dataset, including version number, git commit and R session_info.
      type: list
      elements:
        version:
          description: Version number of the dataset.
          type: categorical
          value:
        git_SHA: Commit in git repository.
        session_info:
          description: The versions of R, packages, and data used to generate the dataset.
          type: categorical
          value: A structured yaml file, represented as a list in R.

#-------------------------------------------------------------

metadata:
  description: &metadata Structured recording of metadata for each individual study, as entered into AusTraits. Information included in `sites` and `methods` are derived from this file. Also includes information on mapping of trait data into standard terms and units, plus any taxonomic changes implemented.
  type: list
  elements:
    source:
      description: Citation details for the original source(s) for the data, whether it is a published journal article, book, website, or thesis.
      type: categorical
      values:
        primary:
          description: &source_primary The original study in which data were collected.
          type: catergorical
          values:
            key: &key The key is used to identify the exact reference using authors last name and year of publication.
            bibtype: &bibtype Entry type for reference source e.g. Article, Book, Thesis, Unpublished.
            year: &year The year that the reference was published, or written in the case of unpublished articles.
            author: &author Names of all the authors for the reference.
            title: &title The title of the reference.
            journal: &journal Journal in which the article was published.
            volume: &volume The volumn number of the article or book.
            number: &number The issue number for a journal article.
            pages: &pages The page numbers for a reference.
            doi: &doi The digital object identifer.
            url: &url The URL of of a web page.
            type: &type The type of thesis which can include PhD, Masters, Honours.
            institution: &institution The institution that published or sponsored the report.
            publisher: &publisher The name of the publisher.
            isbn: &isbn The International Standard Book Number of a book or report.
            place: &place The location where the reference was written or published.
            note: &note Additional notes for the reference which are not contained in the other fields.
        secondary:
          description: &source_secondary A subsequent study where data were compiled or re-analysed.
          type: categorical
          values:
            key: *key
            bibtype: *bibtype
            year: *year
            author: *author
            journal: *journal
            title: *title
            volume: *volume
            number: *number
            pages: *pages
            doi: *doi
            url: *url
            type: *type
            institution: *institution
            publisher: *publisher
            isbn: *isbn
            place: *place
            note: *note
    contributors:
      description: A list of contributors to the study, their respective affiliations, roles in the study, and ORCIDs.
      type: array
      elements:
        data_collectors:
          description: *data_collectors
          last_name: Last name of data collector
          given_name: Given name of data collector
          affiliation: Affiliation of data collector
          notes: optional notes for the data collector
          ORCID: ORCID iD (Open Researcher and Contributor ID) for the data collector, if available
          additional_role: Any additional roles the data collector had in the study, a field most frequently used to identify which data contributor is the contact person for the dataset.
          type: categorical
        assistants:
          description: *assistants
        austraits_curators:
          description: *austraits_curators
    dataset:
      description: Study details, including format of the data, custom R code applied to data, and various descriptors. Each can a header for a column of the data, or actual value to be used.
      type: categorical
      values:
        data_is_long_format: Indicates if the data spreadsheet has a vertical (long) or  horizontal (wide) configuration with `yes` or `no` terminology
        custom_R_code: A field where additional R code can be included. This allows for custom manipulation of the data in the submitted spreadsheet into a different format for easy integration with AusTraits. `.na` indicates no custom R code was used.
        collection_date: *collection_date
        taxon_name: *taxon_name
        site_name: *site_name
        context_name: *context_name
        entity_id: *entity_id
        population_id: *population_id
        individual_id: *individual_id
        observation_id: *observation_id
        trait_name: *trait_name
        value: *value
        description: *description
        collection_type: *collection_type
        sample_age_class: *sample_age_class
        sampling_strategy: *sampling_strategy
        original_file: The name of the file initially submitted to AusTraits
        notes: Generic notes about the study and processing of data
    sites:
      description: A list of study sites and information about each of the study sites where data were collected. Each should include at least three variables - `latitude`, `longitude` and `description`. Additional variables can be included where available. Set to `.na` for botanical collections and field studies where data values are a mean across many locations.
    contexts:
      description: A list of scenarios sites and contextial information about each of the scenarios where data were collected. A list of contexts. Each should include at least two variables - `context_type` and `description`. Additional variables can be included where available. Set to `.na` as default.
    traits:
      description: A translation table, mapping traits and units from a contributed study onto corresponding variables in AusTraits. The methods used to collect the data are also specified here.
      type: array
      elements:
        var_in: Name of trait in the original data submitted
        unit_in: Units of trait in the original data submitted
        trait_name: *trait_name
        entity_type: *entity_type
        value_type: *value_type
        basis_of_value: *basis_of_value
        replicates: *replicates
        measurement_remarks: *measurement_remarks
        method_number: *method_number
        observation_number: *observation_number
        methods: *methods
    substitutions:
      description: A list of any "find and replace" substitutions needed to get the data into the right format.
      type: array
      values:
        trait_name: Trait where substitutions are required
        find: Contributor's trait value that needs to be changed
        replace: AusTraits supported replacement value
    taxonomic_updates:
      description: A table of taxonomic name changes needed to align original names in the dataset with taxa in APC and APNI.
      type: array
      values:
        find: *orginal_name
        replace: *taxon_name
        reason: Records why the change was implemented, e.g. `typos`, `taxonomic synonyms`, and `standardising spellings`
    exclude_observations:
      description: A table of observations to remove from the compilation
      type: array
      values:
        variable: A variable from the traits table, typically `taxon_name`, `site_name` or `context_name`
        find: Value of variable to remove
        reason: Records why the data was removed, e.g. `exotic`
    questions: A place to record any queries we have about the dataset (recorded as a named array), including notes on any additional traits that may have been collected in the study but have not been incorporated into AusTraits.
